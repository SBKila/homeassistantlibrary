title Setup


participantgroup #00878F **Arduino** 
participant ArduinoCode
participant main
participantgroup #62AEB2  **library**
participant HADevice
participant HAAdapter
end
participant PubSubClient
end 
participantgroup #3eb7ed **homeassistant**
participant HANode
participant HAComponent
end 



ArduinoCode->main : setup
activate main
create HADevice
main->HADevice : new
activate HADevice

create PubSubClient
HADevice->PubSubClient : set client,server,callback
HADevice<--PubSubClient :

create HANode
HADevice->HANode : new
HADevice<--HANode :
main<--HADevice:
deactivate HADevice


main->HADevice : setDeviceInfo 
activate HADevice
main<--HADevice :
deactivate HADevice

loop create all device adapters
create HAAdapter
main->HAAdapter : new

main->HAAdapter : setup
activate HAAdapter
loop
create HAComponent
HAAdapter->HAComponent : new
activate HAComponent
HAAdapter<--HAComponent :
deactivate HAComponent
end
main<--HAAdapter :
deactivate HAAdapter

main->HAAdapter : setDevice
activate HAAdapter
HAAdapter->HADevice : addComponent
activate HADevice
HADevice->HANode : addComponent
activate HANode
HADevice<--HANode:
deactivate HANode

HAAdapter<--HADevice:
deactivate HADevice
main<--HAAdapter :


deactivate HAAdapter
end

ArduinoCode <-- main :
deactivate main

